---
description: Patterns for developing the salvageunion-reference package
globs:
  - 'packages/salvageunion-reference/**/*.ts'
alwaysApply: false
---

Patterns for developing the salvageunion-reference package with code generation.

- Package structure: `lib/` for TypeScript files, `data/` for JSON data files, `schemas/` for JSON Schema files, `tools/` for code generation scripts, `dist/` for compiled output (generated, don't edit)
- Always run generation after schema/data changes: `bun run generate`
- NEVER manually edit auto-generated files: `lib/utilities-generated.ts`, `lib/types/schemas.ts`, `lib/types/enums.ts`, `lib/types/common.ts`, `lib/types/objects.ts`, `lib/types/index.ts`, `lib/index.ts` (generated from `lib/index.template.ts`)
- To modify generated code: edit generator scripts in `tools/` directory or template files (e.g., `lib/index.template.ts`), then run `bun run generate`
- Manual overrides: `lib/utilities.ts`, `lib/ModelFactory.ts`, `lib/BaseModel.ts` (not generated)
- All models extend `BaseModel<T>`, created via `ModelFactory`, use `SalvageUnionReference` singleton to access models, models provide: `all()`, `find()`, `findAll()` methods
- Tests use Bun's built-in test runner: test files `*.test.ts`, run tests with `bun test`, tests validate schema compliance and data integrity
- Build process: Generate (`bun run generate`), Type Check (`tsc --project tsconfig.build.json`), Test (`bun test`), Format/Lint, full build: `bun run build`, quick build: `bun run build:quick` (generates and compiles only)
- All data files must match their JSON schemas, use `validateGenerated.ts` to check generated code, use `validateReferences.ts` to check cross-references
- Adding new data: Add JSON file to `data/` directory, add corresponding schema to `schemas/` directory, update `tools/schemaNameMap.ts` if needed, run `bun run generate`, run `bun test` to verify
- Using the package: `import { SalvageUnionReference, type SURefChassis } from 'salvageunion-reference'; const ref = SalvageUnionReference.instance; const chassis = ref.chassis.find((c) => c.id === 'some-id')`
