---
description: Testing patterns and conventions
globs:
  - "**/*.test.ts"
  - "**/*.test.tsx"
  - "**/__tests__/**/*"
alwaysApply: false
---

Testing patterns using Bun's test runner and Testing Library for component tests.

- Package tests: Use Bun's built-in test runner, test files: `*.test.ts` or `*.test.tsx`, test directories: `__tests__/` or co-located with source
- App tests: Use Bun test runner with Testing Library, use `@testing-library/react` for component tests, use `@testing-library/user-event` for interactions, use `@testing-library/jest-dom` for DOM assertions, setup files: `testing-library.ts`, `happydom.ts`
- Use `describe` blocks to group related tests, use `test` or `it` for individual test cases, follow Arrange-Act-Assert pattern, use descriptive test names
- Test user interactions, not implementation details, use `render()` from Testing Library, query by accessible roles/labels when possible, use `waitFor` for async updates
- Mock Supabase client for API tests, use `vi.mock()` for module mocking (Vitest/Bun), mock external dependencies appropriately
- Package test: `test('model finds item by id', () => { const ref = SalvageUnionReference.instance; const item = ref.chassis.find(x => x.id === 'test-id'); expect(item).toBeDefined() })`
- Component test: `test('renders pilot name', () => { const queryClient = new QueryClient(); render(<QueryClientProvider client={queryClient}><PilotComponent id="test-id" /></QueryClientProvider>); expect(screen.getByText('Pilot Name')).toBeInTheDocument() })`
